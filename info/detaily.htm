<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
 "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
	<meta name="Author" content="Juraj Videky">
	<link rel="stylesheet" type="text/css" href="../breviar.css">
	<title>program-detaily</title>
</head>
<body>
<center>
<h2>Informácie | O programe (podrobnejšie)</h2>
^ <a href="program.htm">O programe</a> | ^^ <a href="index.htm">Informácie</a> | <a href="ulohy.htm">Úlohy</a> &gt;&gt;
</center>
<h4 class="blue">Ako to funguje (podrobnejšie)</h4>
<p>Na základe <a href="parametre.htm">vstupnıch parametrov</a> sa program rozhodne, 
ktorú z <a href="ulohy.htm">úloh</a> ide rieši.
Vo väèšine z úloh je potrebné analyzova rok, a to pod¾a (pohyblivého) dátumu ve¾konoènej nedele, ktorá
urèuje ostatné liturgické obdobia. Presnejšie, vykonajú sa nasledovné kroky:
<ol class="level1">
<li>Zistí sa aktuálny dátum.</li>
<li>Pre danı rok sa spustí funkcia <tt>analyzuj_rok()</tt>, ktorá
naplní <a href="struct.htm#rok">štruktúru pre danı (kalendárny) rok</a>, 
ktorá obsahuje dátumy najvıznamnejších medzníkov liturgického roka v danom kalendárnom
roku a charakteristiky roka.
<a name="medznik"></a><i>Medzníkmi</i> pre úèely programu sú:
	<ol class="level2">
	<li>Krst Krista Krá¾a (1. nede¾a v období „cez rok“, ktorou sa konèí Vianoèné obdobie),</li>
	<li>Popolcová streda (zaèína sa Pôstne obdobie),</li>
	<li>Ve¾konoèná nede¾a (konèí sa Pôstne obdobie a zaèína sa Ve¾konoèné obdobie),</li>
	<li>Nanebovstúpenie Pána (konèí sa Ve¾konoèné obdobie a pokraèuje obdobie „cez rok“),</li>
	<li>Prvá adventná nede¾a (konèí sa obdobe „cez rok“, zaèína Adventné obdobie),</li>
	<li>Sviatok Svätej rodiny.</li>
	</ol>
Ostatné pohyblivé slávenia sa ¾ahko vypoèítajú pod¾a medzníkov, napr.:
	<ol class="level2">
	<li>Kvetná nede¾a: 7 dní pred Ve¾konoènou nede¾ou (podobne Zelenı štvrtok,
	Ve¾kı piatok, Biela sobota, Ve¾konoènı pondelok, Nede¾a vo Ve¾konoènej oktáve),</li>
	<li>Najsvätejšej Trojice: 7 dní po Zoslaní Ducha Svätého,</li>
	<li>Najsvätejšieho Tela a Krvi: 11 dní po Zoslaní Ducha Svätého,</li>
	<li>Najsvätejšieho Srdca Jeišovho: 19 dní po Zoslaní Ducha Svätého.</li>
	</ol>
Charakteristikami roka sú:
	<ol class="level2">
	<li>èi je rok <a href="../msg/prestupn.htm">priestupnı</a>,</li>
	<li><a href="../msg/lr_pism.htm">písmeno liturgického roka</a>, ktorı zaèína Prvou adventnou nede¾ou kalendárneho roka,</li>
	<li><a href="../msg/nedpism.htm">nede¾né písmeno/písmená</a> (niekedy nede¾ná litera),</li>
	<li>poradové èíslo tıdòa obdobia „cez rok“, v ktorom zaèína Pôstne obdobie (teda v ktorom je Popolcová streda),</li>
	<li>poradové èíslo tıdòa obdobia „cez rok“, ktorı nasleduje po Nedeli Zoslania Ducha Svätého, ktorou sa konèí Ve¾konoèné obdobie.</li>
	</ol>
</li>
<li>Pre danı dátum sa spustí funkcia <tt>rozbor_dna()</tt>, ktorá naplní 
<a href="struct.htm#den">štruktúru pre kadı deò</a> údajmi jednak kalendárnymi
(deò v tıdni, poradie dòa v roku), „dvak“ liturgickımi (<a href="../msg/lr_pism.htm">liturgickı
rok</a>, liturgické obdobie, tıdeò altára, poradové èíslo slávenia pod¾a
<a href="../docs/smernice_lrk.htm#c59">è. 59</a> 
<a href="../docs/smernice_lrk.htm">Všeobecnıch smerníc o liturgickom roku
a o kalendári</a>, èi je slávenie prikázanım sviatkom, napokon prípadné vlastné meno slávenia),</li>
<li>Pod¾a takto pripravenıch štruktúr sa ¾ahko vygeneruje stránka s aktuálnymi údajmi (dátum, mesiac, roky).</li>
</ol>
<h4 class="blue">Informácie o jednotlivom dni</h4>
Pre generovanie informácie o jednotlivom dni (bez urèenej modlitby) vyzerá
postup programu nasledovne: spustí funkciu&nbsp;<a name="rozbor_dna"></a><tt>rozbor_dna()</tt>
pre danı deò a vısledok zobrazí. Spomínaná funkcia <tt>rozbor_dna()</tt>
je jednou z k¾úèovıch funkèností aplikácie, preto sa jej budem venova trošku podrobnejšie.
<ul class="level1">
<li>1. fáza: <b>Všeobecné liturgické dáta</b>
<br>Táto fáza zaradí danı deò (pod¾a dátumu, presnejšie poradového èísla
dòa v roku) do liturgického obdobia, teda pod¾a medzníkov <a href="#medznik">spomínanıch
vyššie</a> urèí, o aké liturgické obdobie ide. Program pritom interne pouíva nasledovné konštanty:
<ul class="level0">
<li>
<tt>/* liturgicke obdobia */</tt>
<br><tt>//OBD_ADVENTNE</tt>
<br><tt>#define OBD_ADVENTNE_I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1 /* do 16. decembra */</tt>
<br><tt>#define OBD_ADVENTNE_II&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2 /* po 16. decembri */</tt>
<br><tt>//OBD_VIANOCNE</tt>
<br><tt>#define OBD_VIANOCNE_I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3 /* do slavnosti zjavenia pana */</tt>
<br><tt>#define OBD_VIANOCNE_II&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4 /* po slavnosti zjavenia pana */</tt>
<br><tt>//OBD_CEZ_ROK</tt>
<br><tt>#define OBD_CEZ_ROK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
5</tt>
<br><tt>//OBD_POSTNE</tt>
<br><tt>#define OBD_POSTNE_I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
6 /* do soboty v piatom tyzdni */</tt>
<br><tt>#define OBD_POSTNE_II_VELKY_TYZDEN 7 /* velky tyzden */</tt>
<br><tt>//OBD_VELKONOCNE</tt>
<br><tt>#define OBD_VELKONOCNE_TROJDNIE&nbsp;&nbsp;&nbsp; 8 /* umucenia
a zmrtvychvstania Pana */</tt>
<br><tt>#define OBD_VELKONOCNE_I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
9 /* do nanebovstupenia pana */</tt>
<br><tt>#define OBD_VELKONOCNE_II&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
10 /* po nanebovstupeni pana */</tt>
<br><tt>/* nasleduju specialne pod-obdobia */</tt>
<br><tt>#define OBD_VELKONOCNA_OKTAVA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 /*
velkonocna nedela -- 2. velk. ne */</tt>
<br><tt>#define OBD_OKTAVA_NARODENIA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 11 /*
narodenie Pana -- 1. jan. */</tt>
</li>
</ul>
V tejto èasti sa urèia všetky slávenia, ktoré sú v breviári v èastiach
<i>Vlastné èasti liturgickıch období</i> a <i>Slávnosti v období „cez rok“</i>.
Ïalej sa urèia poradové tıdne: tıdeò daného obdobia, tıdeò altára. Urèia
aj prípadné slávenia, ktoré pripadnú na hranièné dni medzi obdobiami (medzníky).
</li>
<li>2. fáza: <b>Liturgické dáta pre sviatky svätıch</b>
<br>Táto fáza pre danı deò (bez oh¾adu na predošlé liturgické zaèlenenie)
zistí poèet sviatkov svätıch (berieme toti do úvahy, e v danı deò môe
by viac ¾ubovo¾nıch spomienok) a pre kadı z nich vytvorí dátovú štruktúru,
ktorá obsahuje najmä názov slávenia, typ slávenia a podštruktúru s dátami,
ktoré urèujú, odkia¾ sa má bra spoloèná èas slávenia. Príklad uvádza
èiastoèné nastavenie dátovıch štruktúr pre dátum 24. apríla:
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty1.typslav = SLAV_LUB_SPOMIENKA;</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty1.smer = 12; /* lubovolne
spomienky podla vseobecneho kalendara */</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; strcpy(_global_svaty1.meno, "Sv. Juraja,
muèeníka");</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty1.spolcast = _encode_spol_cast(MODL_SPOL_CAST_MUCENIK);</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; pocet = 2;</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty2.typslav = SLAV_LUB_SPOMIENKA;</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty2.smer = 12; /* lubovolne
spomienky podla vseobecneho kalendara */</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; strcpy(_global_svaty2.meno, "Sv. Fidéla
zo Sigmaringenu, kòaza a muèeníka");</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty2.spolcast =</tt>
<ul class="level0">
<li>
<tt>&nbsp;&nbsp;&nbsp;&nbsp; _encode_spol_cast(MODL_SPOL_CAST_MUCENIK,
MODL_SPOL_CAST_DUCH_PAST_KNAZ);</tt>
</li>
</ul>
Pripomíname, e v tejto fáze sa všetky slávenia, ktoré sú v breviári zaradené
v èasti <i>Vlastné èasti na sviatky svätıch</i>.
</li>
<li>3. fáza: <b>Porovnanie</b>
<br>Zo všetkıch slávení, prichádzajúcich do úvahy sa uprednostní to slávenie, ktoré má v 
<a href="../docs/smernice_lrk.htm#tabulka">tabu¾ke liturgickıch dní</a> vyšší stupeò. Ak ide o sobotu v období
cez rok, berie sa do úvahy aj spomienka Panny Márie v sobotu.
</li>
</ul>
<h4 class="blue">Vytvorenie modlitby</h4>
Pre generovanie modlitby vyzerá postup programu nasledovne:
<ul>
<li>
ak ide o vešpery/kompletórium, treba generova „nadvakrát“, a to preto,
lebo v prípade, keï prvé vešpery nasledujúceho dòa majú prednos pred vešperami tohto dòa,</li>
<li>
teda v prípade vešpier/kompletória spustí funkciu <tt>rozbor_dna()</tt>
pre nasledujúci deò (a ak si to okolnosti vyadujú, tak aj <tt>analyzuj_rok()</tt>
pre nasledujúci rok), vısledok uchová,</li>
<li>
spustí funkciu <tt>rozbor_dna()</tt> pre danı deò, ako je <a href="#rozbor_dna">popísané
vyššie</a>, a vısledok uchová,</li>
<li>
nastavia sa spoloèné èasti pre slávenia z vlastnej èasti svätıch, a to
pod¾a toho, èo bolo nastavené funkciou <tt>rozbor_dna()</tt> pre danı
deò, ako bolo <a href="#rozbor_dna">popísané vyššie</a>,</li>
<li>
ak slávenie pouíva almy zo altára, spustí sa funkcia, ktorá vráti poadované
almy,</li>
<li>
v prípade vešpier/kompletória zobrazí modlitbu pre ten deò, ktorı má prednos,</li>
<li>
vyššie spomínanı vısledok obsahuje dátovú štruktúru s jednotlivımi zlokami
modlitby, a to dvojice &lt;<i>súbor, kotva</i>&gt; pre kadú èas modlitby.
(Zodpovedá to <a href="text.htm#znackovanie">oznaèkovaniu v jednotlivıch HTML súboroch</a>.)
Pod <i>èasou</i> sa rozumie kadá antifóna, alm, responzórium, hymnus,
modlitba dòa èi slávenia (kolekta), jednoducho všetko, èo sa potenciálne
môe opakova a èasto sa aj opakuje. To je dôvod, preèo sa modlitba generuje,
a nie je v statickej pobode. Istee, pohodlnejšie je celı breviár ma v
statickej podobe tak, ako je, na internete Avšak on-line
breviár umoòuje vygenerova súvislı text modlitby bez toho, e by
bolo potrebné listova v breviári a h¾ada hymnus na inom mieste ako antifóny
a na ïalšom mieste almy resp. chválospev.</li>
<li>
Modlitba sa generuje tak, e do prázdnej šablóny (obsahuje iba nadpisy
jednotlivıch èastí modlitby a pevné súèasti modlitby, ako úvodné Sláva
Otcu èi závereèné poehnanie) sa postupne vkladajú èasti, a to tak, e
daná èas sa h¾adá v súbore <i>súbor</i> od miesta BEGIN:<i>kotva</i> po
miesto END:<i>kotva</i> (a to aj viacnásobne) pod¾a dvojice &lt;<i>súbor,
kotva</i>&gt;, a to pod¾a toho, ako je to v jednotlivom 
<a href="text.htm#znackovanie">zdrojovom HTML súbore vyznaèené</a>.</li>
</ul>
<h4 class="blue">Náèrt ostatnej funkènosti</h4>
Pre generovanie tabu¾ky pohyblivıch slávení vyzerá postup programu nasledovne:
<ul>
<li>pre kadı rok sa spustí funkcia <tt>analyzuj_rok()</tt>, ktorá naplní 
<a href="struct.htm#rok">štruktúru pre danı (kalendárny) rok,</a></li>
<li>jednotlivé údaje sa vypíšu do riadka tabu¾ky (s prípadnımi hypertextovımi odkazmi).</li>
</ul>
Podobne sa generuje aj analıza roka, kde sa naviac generujú aj tlaèidlá
pre nasledujúci a predchádzajúci rok.
<br>
<hr>
<p class="patka">
Autor programovej èasti © 1999-2010 <a href="mailto:videky@breviar.sk">Juraj Vidéky</a>
<br>Všetky práva vyhradené.
</p>
</body>
</html>
