<!-- saved from url=(0022)http://internet.e-mail -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
	<meta name="Author" content="Juraj Videky">
	<link rel="stylesheet" type="text/css" href="../breviar.css">
	<title>program-detaily</title>
</head>
<body>
<center>
<h2>Informace | O programu (podrobnìji)</h2>
^ <a href="program.htm">O programu</a> | ^^ <a href="index.htm">Informace</a> | <a href="ulohy.htm">Úkoly</a> &gt;&gt;
</center>
<h4 class="blue">Jak to funguje (podrobnìji)</h4>
<p>Na základì <a href="parametre.htm">vstupních parametrù</a> se program rozhodne, 
kterou z <a href="ulohy.htm">úloh</a> bude øešit.
Ve vìtšinì úloh je tøeba analýzovat rok, a to podle (pohyblivého) data velikonoèní nedìle, která
urèuje ostatní liturgické doby. Pøesnìji, vykonají se následující kroky: 
<ol class="level1">
<li>Zjistí se aktuální datum.</li>
<li>Pro daný rok se spustí funkce <tt>analyzuj_rok()</tt>, která
naplní <a href="struct.htm#rok">strukturu pro daný (kalendáøní) rok</a>, 
která obsahuje data nejvýznamnìjších mezníkù liturgického roku v daném kalendáøním
roce a charakteristiky roku.
<a name="medznik"></a><i>Mezníky</i> pro úèely programu jsou:
	<ol class="level2">
	<li>Køest Pánì (1. nedìle liturgického mezidobí, kterou konèí Vánoèní doba),</li>
	<li>Popeleèní støeda (zaèíná Postní doba),</li>
	<li>nedìle Zmrtvýchvstání Pánì (konèí Postní doba a zaèíná Velikonoèní doba),</li>
	<li>Seslání Ducha Svatého (konèí Velikonoèní doba a pokraèuje liturgické mezidobí),</li>
	<li>První nedìle adventní (konèí liturgické mezidobí, zaèíná Adventní doba),</li>
	<li>Svátek Svaté rodiny.</li>
	</ol>
Ostatní pohyblivé svátky se lehce vypoèítají podle mezníkù, napø.:
	<ol class="level2">
	<li>Kvìtná nedìle: 7 dní pøed Velikonoèní nedìlí (podobnì Zelený ètvrtek,
	Velký pátek, Bílá sobota, Velikonoèní pondìlí, Nedìle ve Velikonoèním oktávu),</li>
	<li>Nejsvìtìjší Trojice: 7 dní po Seslání Ducha Svatého,</li>
	<li>Tìla a Krve Pánì: 11 dní po Seslání Ducha Svatého,</li>
	<li>Nejsvìtìjšího Srdce Ježíšova: 19 dní po Seslání Ducha Svatého.</li>
	</ol>
Charakteristikami roku jsou:
	<ol class="level2">
	<li>zda je rok <a href="../msg/prestupn.htm">pøestupný</a>,</li>
	<li><a href="../msg/lr_pism.htm">písmeno liturgického roku</a>, který zaèíná První adventní nedìlí kalendáøního roku, </li>
	<li><a href="../msg/nedpism.htm">nedìlní písmeno/písmena</a> (nìkdy nedìlní litera),</li>
	<li>poøadové èíslo týdne „v mezidobí“, v kterém zaèíná Postní doba (tedy v kterém je Popeleèní støeda),</li>
	<li>poøadové èíslo týdne „v mezidobí“, který následuje po Nedìli Seslání Ducha Svatého, kterou konèí Velikonoèní doba.</li>
	</ol>
</li>
<li>Pro dané datum se spustí funkce <tt>rozbor_dne()</tt>, která naplní 
<a href="struct.htm#den">strukturu pro každý den</a> údaji jednak kalendáøními
(den v týdnu, poøadí dne v roce), jednak liturgickými (<a href="../msg/lr_pism.htm">liturgický
rok</a>, liturgická doba, týden žaltáøe, poøadové èíslo slavení podle
<a href="../docs/smer_lrk.htm#c59">è. 59</a> 
<a href="../docs/smer_lrk.htm">Všeobecných smìrnic o liturgickém roce
a o kalendáøi</a>, zda je slavnost zasvìceným svátkem, nakonec pøípadnì vlastní jméno slavnosti).</li>
<li>Podle takto pøipravených struktur se lehce vygeneruje stránka s aktuálními údaji (datum, mìsíc, rok).</li>
</ol>
<h4 class="blue">Informace o jednotlivém dnu</h4>
Pro generování informace o jednotlivém dnu (bez urèené modlitby) vypadá
postup programu následovnì: spustí funkci&nbsp;<a name="rozbor_dna"></a><tt>rozbor_dne()</tt>
pro daný den a výsledek zobrazí. Vzpomínaná funkce<tt>rozbor_dne()</tt>
je jednou z klíèových funkcí aplikace, proto se jí budeme vìnovat trošku podrobnìji.
<ul class="level1">
<li>1. fáze: <b>Všeobecná liturgická data</b>
<br>Tato fáze zaøadí daný den (podle data, pøesnìji poøadového èísla 
dne v roce) do liturgického období, tedy podle mezníkù <a href="#medznik">uvedených 
výše</a> urèí, o jaké liturgické období jde. Program pøitom internì používá následující konstanty: 
<ul class="level0">
<li>
<tt>/* liturgicke obdobia */</tt>
<br><tt>//OBD_ADVENTNE</tt>
<br><tt>#define OBD_ADVENTNE_I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1 /* do 16. decembra */</tt>
<br><tt>#define OBD_ADVENTNE_II&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2 /* po 16. decembri */</tt>
<br><tt>//OBD_VIANOCNE</tt>
<br><tt>#define OBD_VIANOCNE_I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3 /* do slavnosti zjavenia pana */</tt>
<br><tt>#define OBD_VIANOCNE_II&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4 /* po slavnosti zjavenia pana */</tt>
<br><tt>//OBD_CEZ_ROK</tt>
<br><tt>#define OBD_CEZ_ROK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
5</tt>
<br><tt>//OBD_POSTNE</tt>
<br><tt>#define OBD_POSTNE_I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
6 /* do soboty v piatom tyzdni */</tt>
<br><tt>#define OBD_POSTNE_II_VELKY_TYZDEN 7 /* velky tyzden */</tt>
<br><tt>//OBD_VELKONOCNE</tt>
<br><tt>#define OBD_VELKONOCNE_TROJDNIE&nbsp;&nbsp;&nbsp; 8 /* umucenia
a zmrtvychvstania Pana */</tt>
<br><tt>#define OBD_VELKONOCNE_I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
9 /* do nanebovstupenia pana */</tt>
<br><tt>#define OBD_VELKONOCNE_II&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
10 /* po nanebovstupeni pana */</tt>
<br><tt>/* nasleduju specialne pod-obdobia */</tt>
<br><tt>#define OBD_VELKONOCNA_OKTAVA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 /*
velkonocna nedela -- 2. velk. ne */</tt>
<br><tt>#define OBD_OKTAVA_NARODENIA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 11 /*
narodenie Pana -- 1. jan. */</tt>
</li>
</ul>
V této èásti se urèí všechny oslavy, které jsou v breviáøi v èástech
<i>Vlastní èásti liturgických dob</i> a <i>Slavnosti bìhem liturgického mezidobí</i>.
Dále se urèí poøadové týdny: týden daného období, týden žaltáøe. Urèí
se i pøípadné oslavy, které pøipadnou na hranièní dny mezi dobami (mezníky). 
</li>
<li>2. fáze: <b>Liturgická data pro svátky svatých</b>
<br>Tato fáze pro daný den (bez ohledu na pøedešlé liturgické zaèlenìní)
zjistí poèet svátkù svatých (bereme totiž v úvahu, že v daný den mùže
být víc libovolných památek) a pro každý z nich vytvoøí datovou strukturu,
která obsahuje zejména název oslavy, typ oslavy a podstrukturu s daty,
která urèují, odkud se má brát spoleèná èást slavení. Pøíklad uvádí
èásteèné nastavení datových struktur pro datum 24. dubna:
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty1.typslav = SLAV_LUB_SPOMIENKA;</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty1.smer = 12; /* lubovolne
spomienky podla vseobecneho kalendara */</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; strcpy(_global_svaty1.meno, "Sv. Juraja,
muèeníka");</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty1.spolcast = _encode_spol_cast(MODL_SPOL_CAST_MUCENIK);</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; pocet = 2;</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty2.typslav = SLAV_LUB_SPOMIENKA;</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty2.smer = 12; /* lubovolne
spomienky podla vseobecneho kalendara */</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; strcpy(_global_svaty2.meno, "Sv. Fidéla
zo Sigmaringenu, kòaza a muèeníka");</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; _global_svaty2.spolcast =</tt>
<ul class="level0">
<li>
<tt>&nbsp;&nbsp;&nbsp;&nbsp; _encode_spol_cast(MODL_SPOL_CAST_MUCENIK,
MODL_SPOL_CAST_DUCH_PAST_KNAZ);</tt>
</li>
</ul>
Pøipomínáme, že v této fázi jsou všechny oslavy, které jsou v breviáøi zaøazené
v èásti <i>Vlastní texty pro svátky svatých</i>.
</li>
<li>3. fáze: <b>Porovnání</b>
<br>Ze všech oslav, pøicházejících v úvahu, se upøednostní ta oslava, která má v 
<a href="../docs/smer_lrk.htm#tabulka">tabulce liturgických dní</a> vyšší stupeò. Jde-li o sobotu v liturgickém
mezidobí, bere se v úvahu i sobotní památka Panny Marie.
</li>
</ul>
<h4 class="blue">Vytvoøení modlitby</h4>
Pro generování modlitby vypadá postup programu následovnì:
<ul>
<li>
jde-li o nešpory/kompletáø, je tøeba generovat „nadvakrát“, a to proto,
že v pøípadì, kdy první nešpory následujícího dne mají pøednost pøed nešporami
tohoto dne,</li>
<li>
tedy v pøípadì nešpor/kompletáøe spustí funkci <tt>rozbor_dne()</tt>
pro následující den (a pokud si to okolnosti vyžadují, i <tt>analyzuj_rok()</tt>
pro následující rok), výsledek uchová,</li>
<li>
spustí funkci <tt>rozbor_dne()</tt> pro daný den, jak je <a href="#rozbor_dna">popsáno
výše</a>, a výsledek uchová,</li>
<li>
nastaví se spoleèné èásti pro slavení z vlastní èásti svatých, a to
podle toho, co bylo nastaveno funkcí <tt>rozbor_dne()</tt> pro daný
den, jak bylo <a href="#rozbor_dna">popsáno výše</a>,</li>
<li>
pokud oslava používá žalmy ze žaltáøe, spustí se funkce, která vrátí požadované
žalmy,</li>
<li>
v pøípadì nešpor/kompletáøe zobrazí modlitbu pro ten den, který má pøednost,</li>
<li>
výše zmínìný výsledek obsahuje datovou strukturu s jednotlivými složkami
modlitby, a to dvojice &lt;<i>soubor, kotva</i>&gt; pro každou èást modlitby.
(Odpovídá to <a href="text.htm#znackovanie">oznaèení v jednotlivých HTML souborech</a>.)
Pod <i>èástí</i> se rozumí každá antifona, žalm, responsorium, hymnus,
modlitba dne èi slavení (kolekta), jednoduše všechno, co se potenciálnì
mùže opakovat a èasto se i opakuje. To je dùvod, proè se modlitba generuje,
a není ve statické podobì. Jistì je pohodlnìjší mít celý breviáø ve
statické podobì tak, jak je na internetu. Avšak on-line
breviáø umožòuje vygenerovat souvislý text modlitby, aniž by
bylo tøeba listovat v breviáøi a hledat hymnus na jiném místì než antifony
a na dalším místì žalmy resp. chvalozpìv.</li>
<li>
Modlitba se generuje tak, že do prázdné šablony (obsahuje pouze nadpisy
jednotlivých èástí modlitby a pevné souèásti modlitby, jako úvodní Sláva
Otci èi závìreèné požehnání) se postupnì vkládají èásti, a to tak, že
daná èást se hledá v souboru <i>soubor</i> od místa BEGIN:<i>kotva</i> po
místo END:<i>kotva</i> (a to í nìkolikanásobnì) podle dvojice &lt;<i>soubor,
kotva</i>&gt;, a to podle toho, jak je to v jednotlivém 
<a href="text.htm#znackovanie">zdrojovém HTML souboru vyznaèeno</a>.</li>
</ul>
<h4 class="blue">Náèrt ostatních funkcí</h4>
Pro generování tabulky pohyblivých oslav vypadá postup programu následovnì:
<ul>
<li>pro každý rok se spustí funkce <tt>analyzuj_rok()</tt>, která naplní 
<a href="struct.htm#rok">strukturu pro daný (kalendáøní) rok,</a></li>
<li>jednotlivé údaje se vypíší do øádku tabulky (s pøípadnými hypertextovými odkazy).</li>
</ul>
Podobnì se generuje i analýza roku, kde se navíc generují i tlaèítka
pro následující a pøedchozí rok.
<br>
<hr>
<p class="patka">
Autor programové èásti © 1999-2011 <a href="mailto:videky@breviar.sk">Juraj Vidéky</a>
<br>Pomoc pøi pøekladu do èeštiny: Gorazd
<br>Všechna práva vyhrazena.
</p>
</body>
</html>
